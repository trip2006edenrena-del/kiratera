<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚«ãƒ«ãƒ†è¨˜éŒ²</title>
<style>
body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background: #f5f7fa; padding: 80px 20px 20px; }
h1 { margin-top: 0; }
.box { background: #fff; padding: 20px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); margin-bottom: 16px; }
label { font-weight: bold; display: block; margin-bottom: 6px; }
input, textarea { width: 100%; padding: 12px; font-size: 16px; border-radius: 10px; border: 1px solid #ccc; }
textarea { min-height: 80px; }
.star-btn { width: 100%; padding: 14px; margin-top: 10px; font-size: 18px; border-radius: 12px; border: none; cursor: pointer; color: #fff; }
.success { background: #ffd700; color: #000; }
.normal { background: #cfd8dc; color: #000; }
.fail { background: #ff4d4d; color: #fff; }
button { width: 100%; padding: 14px; margin-top: 12px; font-size: 16px; border-radius: 12px; border: none; cursor: pointer; }
.sub { background: #007aff; color: #fff; }
.fixed-top {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: #007aff;
  color: #fff;
  padding: 12px 20px;
  font-size: 16px;
  z-index: 1000;
  border: none;
  cursor: pointer;
  border-radius: 0 0 12px 12px;
}
</style>
</head>
<body>

<button class="fixed-top" onclick="location.href='record_list.html'">ğŸ“„ ä¿å­˜æ¸ˆã¿ã‚«ãƒ«ãƒ†ä¸€è¦§ã¸</button>

<h1>ğŸ“ ã‚«ãƒ«ãƒ†è¨˜éŒ²</h1>

<div class="box">
  <label>ãŠå®¢ã•ã¾å</label>
  <input type="text" id="customer" placeholder="ä¾‹ï¼šå±±ç”°ã•ã¾">
</div>

<div class="box">
  <p id="info"></p>
</div>

<div class="box">
  <label>ä»•ä¸ŠãŒã‚Šè©•ä¾¡</label>
  <button class="star-btn success" onclick="setResult('â­ æˆåŠŸ')">â­ æˆåŠŸ</button>
  <button class="star-btn normal" onclick="setResult('â–³ æ™®é€š')">â–³ æ™®é€š</button>
  <button class="star-btn fail" onclick="setResult('âœ• åçœ')">âœ• åçœ</button>
</div>

<div class="box">
  <label>ãƒ¡ãƒ¢ï¼ˆåçœãƒ»æˆåŠŸãƒã‚¤ãƒ³ãƒˆãªã©ï¼‰</label>
  <textarea id="memo" placeholder="ä¾‹ï¼šæ”¾ç½®æ™‚é–“ãŒå°‘ã—é•·ã‹ã£ãŸã‹ã‚‚"></textarea>
</div>

<button onclick="saveRecord()">ğŸ’¾ ã‚«ãƒ«ãƒ†ã‚’ä¿å­˜</button>
<button class="sub" onclick="location.href='index.html'">è‰²å‘³é¸æŠã«æˆ»ã‚‹</button>
<button class="sub" onclick="history.back()">å‰ã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</button>

<script>
/* URLã‹ã‚‰è‰²å‘³ãƒ»é«ªçŠ¶æ…‹ã‚’å–å¾— */
const params = new URLSearchParams(location.search);
const color = params.get("color");
let hairState = "ä¸æ˜";
if(hair === "color") hairState = "ã‚«ãƒ©ãƒ¼æ¯›";
else if(hair === "bleach") hairState = "ãƒ–ãƒªãƒ¼ãƒæ¯›";

document.getElementById("info").innerHTML =
  `è‰²å‘³ï¼š<strong>${color ?? "ä¸æ˜"}</strong><br>é«ªã®çŠ¶æ…‹ï¼š<strong>${hairState}</strong>`;

function setResult(r) {
  result = r;
  alert("è©•ä¾¡ã‚’é¸æŠã—ã¾ã—ãŸï¼š" + r);
}

function saveRecord() {
  const record = {
    date: new Date().toLocaleString(),
    name: document.getElementById("customer").value,
    color: color ?? "ä¸æ˜",
    hair: hair ?? "ä¸æ˜",
    rating: result,
    memo: document.getElementById("memo").value
  };

  if (!record.name || !record.rating) {
    alert("åå‰ã¨è©•ä¾¡ã¯å¿…é ˆã§ã™");
    return;
  }

  const records = JSON.parse(localStorage.getItem("records") || "[]");
  records.unshift(record);
  localStorage.setItem("records", JSON.stringify(records));

  alert("ã‚«ãƒ«ãƒ†ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼");
  location.href = "record_list.html";
}
</script>
</body>
</html>
